{# map.html.twig #}
{% extends 'base.html.twig' %}

{% block body %}
  
  <div class="row align-items-start">
    <div class="col-6">
        <!-- Form Element sizes -->
        <div class="card card-success">
            <div class="card-header">
                <h3 class="card-title">Carte</h3>
            </div>
            <div class="card-body">
                <div id="map" style="width: 100%; height: 400px;"></div>
            </div>
            <!-- /.card-body -->
        </div>
    </div>
       <div class="col-6">
            <!-- Form Element sizes -->
            <div class="card card-success">
              <div class="card-header">
                <h3 class="card-title">Liste des points de ravitaillement</h3> {% if is_granted('ROLE_ADMIN') %} <a href="{{ path('app_carburant_new') }}" style="float: right;" class="btn btn-primary"><i class="fa-sharp fa-solid fa-plus"></i></a>{% endif %}
              </div>
              <div class="card-body">

                <!-- Formulaire de filtre par mission -->
                <form action="{{ path('app_carburant_index') }}" method="get">
                    <label for="mission">Filtrer par mission :</label>
                    <select id="mission" name="mission">
                        <option value="">Toutes les missions</option>
                        {% for mission in missions %}
                            <option value="{{ mission.id }}">{#{ mission.nom }#}</option>
                        {% endfor %}
                    </select>
                    <button type="submit" class="btn btn-primary">Filtrer</button>
                </form>
                <table id="example1" class="table table-striped">
        <thead>
            <tr><th>Numero</th>
                <th>Nom de la station</th>
                {#<th>Quantite</th>
                <th>Montant</th>
                <th>longitude</th>
                <th>latitude</th>
                <th>Users</th>#}
                <th>Date d'ajout</th>
                <th>actions</th>
            </tr>
        </thead>
        <tbody>
        {% for carburant in carburants %}
            <tr>
                <td>{{ carburant.id }}</td>
                <td>{{ carburant.nom }}</td>
                {#<td>{{ carburant.quantite }} L</td>
                <td>{{ carburant.Montant }} F CFA</td>
                <td>{{ carburant.longitude }}</td>
                <td>{{ carburant.latitude }}</td>
                <td>{{ carburant.user }}</td>#}
                <td>{{ carburant.date ? carburant.date|date('d-m-Y H:i:s') : '' }}</td>
                <td>
                   {#} <a href="{{ path('app_carburant_show', {'id': carburant.id}) }}">show</a>
                    <a href="{{ path('app_carburant_edit', {'id': carburant.id}) }}">edit</a> #}
                    <a href="#" class="btn btn-info"><i class="fa-solid fa-eye fa-xl" style="color: #FFFFF;"></i></a>
                    <a href="{{ path('app_carburant_show', {'id': carburant.id}) }}" class="btn btn-secondary"><i class="fa-solid fa-pen-to-square"  ></i></a>
                    <a class="btn">{{ include('carburant/_delete_form.html.twig') }}</a>
                    
                </td>
            </tr>
        {% else %}
            <tr>
                <td colspan="4">no records found</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>

              </div>
              <!-- /.card-body -->
         </div>
    </div>


  <script>
    var myMap = L.map('map').setView([17.6078, 8.0817], 6);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(myMap);

    {% for carburant in carburants %}
      // Ajouter un marqueur pour chaque carburant avec les coordonn√©es latitude et longitude
      L.marker([{{ carburant.latitude }}, {{ carburant.longitude }}]).addTo(myMap).bindPopup("{{ carburant.nom }} - {{ carburant.date ? carburant.date|date('d-m-Y H:i:s') : '' }}");
    {% endfor %}
  </script>
{% endblock %}
